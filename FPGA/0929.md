# ç¬¬åä¸‰è®² è®¡æ•°å™¨  
## å®è·µæ“ä½œ  
- æ³¢å½¢å›¾  
![](./res/0929_1.png)  
è¯´æ˜ï¼šMæ˜¯1så†…LEDç¯â€œäº®-æš—â€å‘¨æœŸçš„ä¸ªæ•°ï¼Œå¯ä»¥é€šè¿‡1/æ—¶é’Ÿä¸»é¢‘å¾—åˆ°ã€‚åœ¨è¿™é‡Œï¼Œæ—¶é’Ÿé¢‘ç‡æ˜¯50MHzï¼Œå¯ä»¥è®¡ç®—å¾—åˆ°$M=5\times10^7$,å› æ­¤è¿™æ—¶å°±å¯ä»¥è®¡ç®—$\frac{M}{2}-1=24\_999\_999$ã€‚å°†å…¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼Œå¯ä»¥å¾—åˆ°å®ƒçš„ä½å®½æ˜¯25.  

- ç¼–å†™ä»£ç   
```Verilog
//ä¸»æ¨¡å—
module counter
#(
    parameter   CNT_MAX = 25'd24_999_999//å®šä¹‰äº†ä¸€ä¸ªå¸¸é‡
)
(
    input   wire    sys_clk,
    input   wire    sys_rst_n,

    output  reg     led_out
);


reg     [24:0]      cnt;//è®¡æ•°ï¼Œ24ä½å®½


always@(posedge sys_clk or negedge sys_rst_n)
    if(sys_rst_n == 1'b0)//ä¸€æ—¦å¤ä½ä¿¡å·æ¿€æ´»
        cnt <= 25'd0;//ç«‹åˆ»å°†è®¡æ•°å™¨å½’é›¶
    else    if(cnt == CNT_MAX)//å¦‚æœæ²¡æœ‰æ¿€æ´»ï¼Œ
        cnt <= 25'd0;//å°±åœ¨åˆ°è¾¾æœ€å¤§æ—¶å½’é›¶
    else 
        cnt <= cnt + 25'd1;//æˆ–è€…æ˜¯åœ¨ä¸€èˆ¬æƒ…å†µä¸‹+1
        
        
        
always@(posedge sys_clk or negedge sys_rst_n)
        if(sys_rst_n ==  1'b0)
            led_out <= 1'b0;//å¦‚æœå¤ä½ä¿¡å·æ¿€æ´»ï¼Œå°±å°†ledè®¾ä¸º0
        else    if(cnt == CNT_MAX)
            led_out <= ~led_out;//å¦‚æœåˆ°è¾¾æœ€å¤§å€¼å°±åè½¬
        else
            led_out <= led_out;//å¦‚æœæ˜¯ä¸€èˆ¬æƒ…å†µå°±ä¿æŒå€¼ä¸å˜


endmodule
```

```Verilog
//ä»¿çœŸä»£ç 
`timescale 1ns/1ns 
module  tb_counter();

reg     sys_clk;
reg     sys_rst_n;

wire    led_out;

initial
    begin
        sys_clk =  1'b1;
        sys_rst_n <= 1'b0;//å…ˆå°†å¤ä½ä¿¡å·æ¿€æ´»ä¸€æ®µæ—¶é—´
        #20//ç­‰å¾…20çº³ç§’
        sys_rst_n <= 1'b1;//deactiveå¤ä½ä¿¡å·ï¼Œä»¿çœŸå¼€å§‹
    end
    
always #10 sys_clk = ~sys_clk;//æ¯éš”10nsåè½¬ä¸€æ¬¡sys_clk,æ¨¡æ‹Ÿæ—¶é’Ÿä¿¡å·


counter
#(
    .CNT_MAX(25'd24)//åœ¨ä»¿çœŸæ—¶ï¼ŒæŒ‰ç…§24è®¡ç®—ï¼Œè€Œä¸æ˜¯24_999_999
)counter_inst
(
    .sys_clk    (sys_clk),
    .sys_rst_n  (sys_rst_n),

    .led_out    (led_out)
);

endmodule
```

- ä»¿çœŸç»“æœï¼šæ¯éš”24nsï¼Œledç¯çš„çŠ¶æ€åè½¬ä¸€æ¬¡ã€‚ï¼ˆè€Œä¸æ˜¯å®é™…ä¸Šçš„0.5sï¼ŒåŸå› è§è¯¥mdæ–‡ä»¶çš„ç¬¬70è¡Œï¼‰ï¼ˆå¿˜äº†æˆªå›¾äº†ï¼‰  
- æ‚²ä¼¤çš„æ•…äº‹ï¼šæ˜¨å¤©å†™äº†ä¸€éè¿™ä¸ªä¸œè¥¿ï¼Œä¸€ä¸Šæ¥å°±ä¸Šæ¿éªŒè¯ï¼Œç»“æœledä¸€ç›´äº®ç€ã€‚åˆä»¿çœŸéªŒè¯ï¼Œç»“æœä¸çŸ¥é“å“ªé‡Œå‡ºäº†é—®é¢˜ï¼Œled_outä¸€ç›´ä¿æŒé«˜ç”µå¹³ã€‚ä»Šå¤©é‡å†™çš„æ—¶å€™æŠŠæ˜¨å¤©çš„åˆ äº†ï¼Œç°åœ¨æ‰¾ä¸åˆ°äº†T_T  
### å°è¯•ç§»æ¤åˆ°å®‰è·¯çš„æ¿å­ä¸Š  
åœ¨ç»‘å®šå¼•è„šé‚£ä¸€æ­¥ï¼Œæˆ‘æŠŠsys_clkç»‘å®šåˆ°äº†R7(å…¨å±€æ—¶é’Ÿä¿¡å·),led_outç»‘å®šåˆ°äº†B14(ä¸€ä¸ªLEDç¯),å¤ä½ä¿¡å·ç»‘å®šåˆ°äº†A9(ä¸€ä¸ªæ‹¨åŠ¨å¼€å…³)ã€‚  
ç»è¿‡è§‚å¯Ÿï¼Œåœ¨å¼€å…³æ‰“å¼€æ—¶ï¼Œledç¯å‘¨æœŸæ€§é—ªçƒï¼›åœ¨å¼€å…³å…³é—­æ—¶ï¼Œledç¯ç†„ç­ã€‚
### è„‰å†²æ ‡å¿—ä¿¡å·
- æ¯å½“cntè¾¾åˆ°æŸä¸€å€¼æ—¶å°±æ¿€æ´»ä¸€æ¬¡
- å¯ä»¥ä½¿ä»£ç æ›´åŠ ç®€ä»‹ï¼Œè€Œä¸”å‡å¦‚å®ƒåœ¨å¤šå¤„è¢«ä½¿ç”¨ï¼Œå¯ä»¥èŠ‚çœé€»è¾‘èµ„æº  
ä¾æ®æ­¤å¯¹ä»£ç åŠé€†è¡Œä¿®æ”¹ï¼š  
```Verilog
//æ­¤å¤„åªå†™å‡ºå…³é”®è¯­å¥
reg     cnt_flag;//å£°æ˜ä¸€ä¸ªè„‰å†²ä¿¡å·
//ä½¿ç”¨alwaysè¯­å¥ï¼Œå› æ­¤ä¸ºregå‹

//è¿™ä¸ªalwayså—è´Ÿè´£å¤„ç†è„‰å†²ä¿¡å·cnt_flag
always@(posedge sys_clk or negedge sys_rst_n)
    if(sys_rst_n == 1'b0)//å¦‚æœå¤ä½ä¿¡å·æ¿€æ´»
        cnt_flag <= 1'b0;//å°±è®¾å®šä¸ºä½ç”µå¹³
    else if(cnt == (CNT_MAX-1))
        cnt_flag <= 1'b1;
    else 
        cnt_flag <= 1'b0;
```  
# ç¬¬åå››è®² åˆ†é¢‘å™¨â€”â€”å¶åˆ†é¢‘  
## ç†è®ºå­¦ä¹   
- ä¸€èˆ¬å¼€å‘æ¿åªæœ‰ä¸€ä¸ªæ—¶é’Ÿã€‚å¦‚æœæƒ³è¦å¾—åˆ°æ¯”å›ºå®šæ—¶é’Ÿæ›´æ…¢çš„é¢‘ç‡ï¼Œåˆ™è¦è¿›è¡Œåˆ†é¢‘ã€‚  
- å¶æ•°åˆ†é¢‘å™¨çš„å€æ•°æ˜¯å¶æ•°ã€‚å¥‡æ•°â€¦â€¦  
- åˆ†é¢‘å™¨å’Œè®¡æ•°å™¨éå¸¸ç±»ä¼¼ã€‚  
## å®æˆ˜æ¼”ç»ƒ  
- è®¾è®¡ä¸€ä¸ªå¯¹ç³»ç»Ÿæ—¶é’Ÿå…­åˆ†é¢‘çš„åˆ†é¢‘ç”µè·¯   

å°è¯•è‡ªå·±å†™ä¸€ä¸‹
```Verilog
module divider_six
(
input   wire    sys_clk,
input   wire    sys_rst_n,

output  reg     clk_out
);

reg    [1:0]   cnt;

always@(posedge sys_clk or negedge sys_rst_n)
    if(sys_rst_n == 1'b0)
        cnt <= 1'b0;
    else if(cnt == 2'd2)
        cnt <= 2'd0;
    else
        cnt <= cnt + 2'd1;

always@(posedge sys_clk or negedge sys_rst_n)
    if(sys_rst_n == 1'b0)
        clk_out <= 1'b0;
    else if (cnt == 2'd2)
        clk_out <= ~clk_out;
    else
        clk_out = clk_out;
        
endmodule
```  
- è®°å½•è§†é¢‘ä¸­çš„å’Œæˆ‘ä¸ä¸€æ ·çš„åœ°æ–¹  
```
1.è§†é¢‘ä¸­clk_outä½¿ç”¨çš„æ˜¯wireå‹ï¼Œè€Œæˆ‘ä½¿ç”¨çš„æ˜¯regå‹ã€‚ï¼ˆéš¾é“ä¸æ˜¯ä½¿ç”¨alwaysè¯­å¥èµ‹å€¼çš„éƒ½æ˜¯regå‹å—ğŸ‘€æˆ‘ä¹‹å‰ç”¨çš„wireå‹è¿˜æŠ¥é”™äº†ï¼‰ï¼ˆè¡¥ï¼šè§†é¢‘æ”¹å›å»äº†ï¼‰
```

ä»¿çœŸä»£ç 
```Verilog
`timescale 1ns/1ns 
module tb_divider_six();

reg     sys_clk;
reg     sys_rst_n;
wire    clk_out;

initial
    begin
        sys_clk = 1'b1;
        sys_rst_n <= 1'b0;
        #20
        sys_rst_n <= 1'b1;
    end

always #10 sys_clk <= ~sys_clk;

divider_six divider_six_inst
(
   .sys_clk     (sys_clk),
   .sys_rst_n   (sys_rst_n),

   .clk_out     (clk_out)
);


endmodule
```
**æ³¨æ„ï¼** è¿™æ ·åˆ†é¢‘äº§ç”Ÿçš„ä½é¢‘æ—¶é’Ÿæ˜¯ä¸èƒ½ç›´æ¥å½“ä½œç³»ç»Ÿæ—¶é’Ÿä½¿ç”¨çš„ã€‚æ—¶é’Ÿä¿¡å·å¿…é¡»è¿æ¥åˆ°å…¨å±€æ—¶é’Ÿç½‘ç»œï¼ˆå…¨å±€æ—¶é’Ÿæ ‘ï¼‰ï¼Œè¿™æ ·æ‰èƒ½ä½¿å¾—æ—¶é’Ÿä¿¡å·åˆ°è¾¾æ¯ä¸ªå¯„å­˜å™¨çš„æ—¶é—´å°½é‡ç›¸åŒï¼Œå‡å°‘æ—¶åºé—®é¢˜çš„äº§ç”Ÿã€‚  
ç”¨ä¸Šè¿°æ–¹æ³•äº§ç”Ÿçš„æ—¶é’Ÿä¿¡å·ï¼Œä¸å¦‚ç³»ç»Ÿæ—¶é’Ÿç¨³å®šã€‚  
ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œéœ€è¦ç”¨åˆ°ä¸Šä¸€èŠ‚å­¦åˆ°çš„è„‰å†²æ ‡å¿—ä¿¡å·ã€‚  
## è§£å†³æ–¹æ¡ˆ