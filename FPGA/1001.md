# 第十四讲 偶分频器  
- 回顾：上次用类似计数器的方法实现了一个六分频器，实现了将系统时钟的频率降低了六倍。但是这样的实现是不够好的。因为新的clk_out并未连接到全局时钟网络。在系统时钟频率足够高的时候，就会产生各种问题。解决方法是，使用一个脉冲标志信号。  
### 解决方案  
```Verilog
reg     [2:0]   cnt;//cnt计数的最大值变为5，位宽改为3
reg     clk_flag;//脉冲标志信号

always@(posedge sys_clk or negedge sys_rst_n)
    if(sys_rst_n == 1'b0)
        cnt <= 3'd0;
    else if (cnt == 3'd5)//cnt计数信号的最大值改为5
        cnt <= 3'd0;
    else
        cnt <= cnt + 3'd1;

always@(posedge sys_clk or negedge sys_rst_n)
    if(sys_ret_n == 1'b0)
        clk_flag <= 1'b0;
    else if(cnt == 3'd5)
        clk_flag <= 1'b1;
    else
        clk_flag <= 1'B0;
```

这样，在需要用到低频时钟的时候，只需要：  
```Verilog
always@(posedge sys_clk or negedge sys_rst_n)
    if(sys_ret_n == 1'b0)
        ......
    else if(clk_flag == 1'b1)//如果检测到系统时钟的上升沿且clk_flag也被激活的话，就......
        ......
```
相比原来的方案，新的方案在always@语句的检测条件中使用系统时钟为检测条件（而不是新生成的信号）。  
# 第十五讲 奇分频  
