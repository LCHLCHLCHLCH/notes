### F1系统架构  
-主动单元：D-Bus,S-Bus,通用DMA1，通用DMA2（数据搬运工）  
- 被动单元：flash，sram，fsmc，AHB到APB的桥  

## 存储器映射  
存储器本身是没有地址信息的。对存储器 __分配地址的过程__ 叫做存储器映射。  
### ST将4GB地址空间分为8块，用于不同的功能。  
- Block0：用户代码，bootloader等  
- Block1：64kb SRAM，其余地方都是保留的  
- Block2：APB1总线外设；APB2总线外设；AHB总线外设  

## 寄存器映射  
寄存器可以实现对单片机内部外设的控制。我的理解是，寄存器和外设是直接或间接相连的。  
### 寄存器分类
- 存储器映像：

32一组GPIO有16个：PA0~PA15......

寄存器映射举例：
```C
//直接操作寄存器地址
*(unsigned int *)(0x4001080c) = 0xffff;
```
```C
//定义名字以后再操作
#define GPIOA_ODR *(unsigned int *)(0x4001080c)
```

### 寄存器地址计算  
- 总线基地址(BUS_BASE_ADDR)
- 外设基于总线基地址的偏移量(PERIPH_OFFSET)
- 寄存器相对于外设基地址的偏移量(REG_OFFSET)

寄存器地址 = BUS_BASE_ADDR + PERIPH_OFFSET + REG_OFFSET

### 使用结构体完成寄存器的映射
---
---
---
## GPIO  
保护二极管可以防止过高或过低的电压，从而达到保护GPIO的作用。但是也不能接太大功率的外设，比如电机。  
GPIO的输出状态：由两个MOS管控制，实现推挽输出和开漏输出两种状态。
- 推挽输出：在检测到高（低）电平后将电源正（负）极直接连接到输出口。缺点是不能实现线与的功能。
- 开漏输出：高电平没有驱动能力，低电平有驱动能力。在输出口接一个上拉电阻，会使得该输出口默认高电平。  

GPIO的输入  
- 肖特基触发器：将模拟信号转换为数字信号

