# 中断系统 
- 中断:暂停执行当前的程序,转而去执行其他程序  
- 中断优先级和中断嵌套:一个中断还可以被优先级更高的中断打断  
- 被暂停的地方成为断点。  
- 在中断的时候会对现场进行保护。  
```C
int main(){
	while(1){
		/*主程序*/
	}
}

void EXTI0IQRHandler(void){
	/*中断程序*/
	/*中断时会自动执行这个程序*/
}
```

- stm32的中断包含EXTI,TIM,SPI...  
- NVIC(嵌套中断向量控制器)用于管理中断优先级
- 使用C语言编程不需要管中断向量表。  

### NVIC的基本结构  
用于同一分配中断优先级和管理中断。它是CPU的小助手。它可以接受多个输入,有一个输出口和CPU相连,用于告诉CPU处理哪一个中断。  
- 抢占优先级:可以让CPU中断手头的任务来处理  
- 响应优先级:排到队伍的最前面,但是不能让CPU停止手头的任务来处理它。  

## EXTI中断之一:EXTI外部中断  
EXTI可以检测指定GPIO口的电平变化,它可以在引脚电平变化时触发中断。  
类似于:  
```verilog
always@(posedge GPIO or negedge GPIO)
```  
它支持所有的GPIO口,但是pin一样的端口不能同时触发中断。也可以不触发中断而去触发其他外设。  

### 需要使用外部中断的情况  
突发的信号,比如旋转编码器  
按键检测可以用定时器中断,既能处理消抖的问题,又能不阻塞主程序。